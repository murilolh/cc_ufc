<html><head><title>Animação 2D</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta content="MSHTML 6.00.2722.900" name="GENERATOR"><link title="Introdução à computação gráfica com OpenGL" href="http://www.ceset.unicamp.br/%7Emagic/opengl/index2006.html" rel="HOME"><link title="Exercícios" href="http://www.ceset.unicamp.br/%7Emagic/opengl/modelos-iluminacao-exercicios.html" rel="PREVIOUS"><link title="Outros" href="http://www.ceset.unicamp.br/%7Emagic/opengl/animacao-outros.html" rel="NEXT"></head><body text="#000000" bgcolor="#ffffff">
<div class="NAVHEADER">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tbody>
  <tr>
    <th colspan="3" align="middle">Introdução à computação gráfica com 
OpenGL</th></tr>
  <tr>
    <td valign="bottom" width="10%" align="left"><a href="http://www.ceset.unicamp.br/%7Emagic/opengl/modelos-iluminacao-exercicios.html">Prev</a></td>
    <td valign="bottom" width="80%" align="middle"></td>
    <td valign="bottom" width="10%" align="right"><a href="http://www.ceset.unicamp.br/%7Emagic/opengl/animacao-outros.html">Next</a></td></tr></tbody></table>
<hr width="100%" align="left">
</div>
<div class="CHAPTER">
<h1><a name="ANIMACAO">Capítulo 7. Animação 2D</a></h1>
<div class="TOC">
<dl>
  <dt><b>Índice</b>
  </dt><dt>7.1. <a href="http://www.ceset.unicamp.br/%7Emagic/opengl/animacao-2D.html#animacao">Descrição 
  do programa <tt class="FILENAME">anima_telejogo.c</tt></a>
</dt><dt>7.2. <a href="http://www.ceset.unicamp.br/%7Emagic/opengl/animacao-outros.html">Outros programas relacionados</a>
  </dt><dt>7.3. <a href="http://www.ceset.unicamp.br/%7Emagic/opengl/animacao-exercicios.html">Exercícios</a></dt></dl></div>
<p>O propósito desta lição é ilustrar os conceitos 
envolvidos na geração de uma animação no OpenGL. Neste caso, animação é feita em
2D e trata-se de um antigo jogo da década de 80, chamado de Telejogo, como ilustrado
na <a href="http://www.ceset.unicamp.br/%7Emagic/opengl/animacao-2D.html#FIG-ANIMACAO">Figura 7-1</a>. </p>
<p>O jogo consiste em um campo de futebol com dois jogadores, uma bola e duas traves (esses 
elementos não estão todos presentes na figura abaixo). Os jogadores movimentam-se na
horizontal e vertical; a bola movimenta-se em diversas 
direções (não implementados). O objetivo do jogo, logicamente, é marcar gol.</p>
<div class="FIGURE">
<p><b><a name="FIG-ANIMACAO">Figura 7-1. Um frame do Telejogo.</a></b></p>
<p><img src="7.animacao-2D_arquivos/telejogo.jpg"></p></div>
<p>O programa usado para modelar esta cena é mostrado no <a href="http://www.ceset.unicamp.br/%7Emagic/opengl/animacao-2D.html#EXAMPLE-ANIMACAO">Exemplo 
7-1</a>. A única tecla habilitada é a <b class="KEYCAP">ESC</b>, utilizada para
finalizar o programa. </p>
<div class="EXAMPLE">
<p><b><a name="EXAMPLE-ANIMACAO">Exemplo 7-1. programa </a><a href="http://www.ceset.unicamp.br/%7Emagic/opengl/anima_telejogo.c" target="_top"><tt class="FILENAME">anima_telejogo.c</tt></a></b></p>
<table width="100%" bgcolor="#e0e0e0" border="0">
  <tbody>
  <tr>
    <td><pre class="PROGRAMLISTING">/* programa TELEJOGO */
/* Prof. Marco Antonio G. de Carvalho, UNICAMP-2006 */
/* EXEMPLO DE ANIMACAO */

#include &lt;stdlib.h&gt;
#include &lt;GL/glut.h&gt;

GLint movebola=0;
GLint direcao=1;

void init(void);
void display(void);
void bola(int passo);
void keyboard(unsigned char key, int x, int y);

int main(int argc, char** argv){
  glutInit(&amp;argc, argv);
//  glutInitDisplayMode (GLUT_SINGLE | GLUT_RGB);
  glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB);
  glutInitWindowSize (600, 400);
  glutInitWindowPosition (100, 100); 
  glutCreateWindow ("TELEJOGO");
  init();
  glutDisplayFunc(display);
  glutTimerFunc(10,bola,1);
  glutKeyboardFunc(keyboard);
  //glutMouseFunc(mouse);
  glutMainLoop();
  return 0;
}

void init(void){
  glClearColor(0.0, 0.0, 0.0, 0.0);
  glOrtho (0, 600, 0, 400, -1 ,1);
}

void display(void){
  glClear(GL_COLOR_BUFFER_BIT);

 // glPolygonMode(GL_BACK, GL_LINE);
  glColor3f(1.0, 1.0, 1.0);
  glLineWidth(15.0);
  glBegin(GL_LINE_LOOP);
  glVertex2i(2,2);  glVertex2i(599,2);
  glVertex2i(599,399); glVertex2i(2,399);
  glEnd();

  glBegin(GL_LINES);
  glVertex2i(100,190);  glVertex2i(100,240);
  glVertex2i(500,190);  glVertex2i(500,240);
  glEnd();

  glPointSize(15.0);
  glBegin(GL_POINTS);
  glVertex2i(movebola+200,210);
  glEnd();

//  glFlush();
  glutSwapBuffers();
 }

void keyboard(unsigned char key, int x, int y){
  switch (key) {
  case 27:
	exit(0);
	break;
  }
}

void bola(int passo)
{
if(direcao==1)
{
movebola += 1;
if(movebola==290) direcao = 0;
}

else
{
movebola -= 1;
if(movebola==-90) direcao = 1;
}
glutPostRedisplay();
glutTimerFunc(10,bola, 1);

}</pre></td></tr></tbody></table></div>
<p>Para compilar e executar o programa <a href="http://www.ceset.unicamp.br/%7Emagic/opengl/anima_telejogo.c" target="_top"><tt class="FILENAME">anima_telejogo.c</tt></a>, salve-o juntamente com o 
arquivo <a href="http://www.ceset.unicamp.br/%7Emagic/opengl/Makefile" target="_top">Makefile</a> em um diretório e execute a seguinte seqüência de 
comandos:</p>
<table width="100%" bgcolor="#e0e0e0" border="0">
  <tbody>
  <tr>
    <td><pre class="SCREEN"><tt class="PROMPT">$</tt> <b class="COMMAND">make</b> <span class="OPTION">iluminacao</span>
<tt class="PROMPT">$</tt> <b class="COMMAND">./anima_telejogo</b></pre></td></tr></tbody></table>
<div class="SECT1">
<h1 class="SECT1"><a name="MODELOS-ILUMINACAO-DESCRICAO">7.1. Descrição do programa 
<tt class="FILENAME">anima_telejogo.c</tt></a></h1>

<div class="INFORMALEXAMPLE">
<p>A idéia central da animação neste programa consiste em criar um laço que altere as 
transformações geométricas presentes na função <tt class="FUNCTION">display</tt> . Para isso, é utilizada a função
<tt class="FUNCTION">glutTimerFunc()</tt> , cuja sintaxe é dada a seguir.</p>
<p><tt class="FUNCTION">glutTimerFunc(unsigned int msecs, void (*func)(int value), int value)</tt>
Associa uma função de <i>callback</i> que deve ser executada de tempos em tempos, definido pelo
primeiro parâmetro <i>msecs</i>; o parâmetro <i>func</i> corresponde ao nome da função que deve ser 
chamada e o parâmetro <i>value</i> consiste em um valor inteiro definido pelo usuário, passado
para a função <i>func</i> e que pode ou não ser utilizado por esta.</p>
<p>A linha de programa</p>

<table width="100%" bgcolor="#e0e0e0" border="0">
  <tbody>
  <tr>
    <td><pre class="PROGRAMLISTING">  glutTimerFunc(10,bola,1);
</pre></td></tr></tbody></table>
<p></p></div>
<p>Define o período entre a execução da chamada da função <tt class="FUNCTION">bola</tt> de 10msecs e passa
para a função o valor inteiro 1. Esse valor poderá (ou não) ser utilizado como o 
incremento (passo) na posição da bola do jogo.</p>
<div class="INFORMALEXAMPLE">
<p></p>
<table width="100%" bgcolor="#e0e0e0" border="0">
  <tbody>
  <tr>
    <td><pre class="PROGRAMLISTING">if(direcao==1)
{
movebola += 1;
if(movebola==290) direcao = 0;
}</pre></td></tr></tbody></table>
<p></p></div>
<p>A variável <i>movebola</i> controla até que posição mais a esquerda ou mais a direita a bola 
pode se locomover, enquanto que a variável <i>direcao</i> controla a mudança de direção quando
a bola atinge esses limites laterais, incrementando ou decrementado a variável <i>movebola</i>.</p>
<div class="NAVFOOTER">
<hr width="100%" align="left">

<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tbody>
  <tr>
    <td valign="top" width="33%" align="left"><a href="http://www.ceset.unicamp.br/%7Emagic/opengl/modelos-iluminacao.html">Prev</a></td>
    <td valign="top" width="34%" align="middle"><a href="http://www.ceset.unicamp.br/%7Emagic/opengl/index2006.html">Home</a></td>
    <td valign="top" width="33%" align="right"><a href="http://www.ceset.unicamp.br/%7Emagic/opengl/animacao-outros.html">Next</a></td></tr>
  <tr>
    <td valign="top" width="33%" align="left">Exercícios</td>
    <td valign="top" width="34%" align="middle">&nbsp;</td>
    <td valign="top" width="33%" align="right">Outros Programas relacionados</td></tr></tbody></table></div></div></div></body></html>